# Mesh-Extension-Updater

In order to integrate the endpoint-auth-service with [Openshift Service Mesh](https://cloud.redhat.com/learn/topics/service-mesh), the [endpoint-configuratio-service](../endpoint-configuration-service) supports the generation of [ServiceMeshExtension's](https://docs.openshift.com/container-platform/4.6/service_mesh/v2x/ossm-extensions.html). 
To automatically deploy them to the cluster, the mesh-extension-updater can watch a given folder, containing the mesh-extension file(generated by the [endpoint-configuration-service](../endpoint-configuration-service). On every create or patch event, it uses the [Kubernetes Server-Side Apply API](https://kubernetes.io/docs/reference/using-api/server-side-apply/) to patch the extension into the mesh. Depending on the concret configuration of the mesh, it will then be picked-up and inserted to the selected workloads.

Configuration:

| Env-Var                  | Description                                        | Default                     |
|--------------------------|----------------------------------------------------|-----------------------------|
| MESH_CONFIG_FOLDER       | Folder to listen for changes.                      | /mesh-config                |
| MESH_EXTENSION_FILE_NAME | Filename of the extension inside the folder.       | service-mesh-extension.yaml |